<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>argenmap.jquery v2</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Bootplus -->
		<link href='http://fonts.googleapis.com/css?family=Roboto:400,300,700' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="css/font-awesome.min.css">
		<link href="css/bootplus.min.css" rel="stylesheet" media="screen">
		<link href="css/bootplus-responsive.min.css" rel="stylesheet" media="screen">
		<link href="js/google-code-prettify/prettify-default.css" rel="stylesheet">
		<!--[if IE 7]>
		<link rel="stylesheet" href="css/bootplus-ie7.min.css">
		<![endif]-->
		<style>
			section {
				 margin-top: 30px;
				 margin-left: -20px;
				 margin-right: -20px;
				 padding-top: 30px;
				 padding: 19px;

				 border: 1px solid #d8d8d8;
				 background-color: #ffffff;
				 border-top-width: 0;
				 border-bottom-width: 2px;
				 -webkit-border-radius: 3px;
						-moz-border-radius: 3px;
								 border-radius: 3px;
				 -webkit-box-shadow: none;
						-moz-box-shadow: none;
								 box-shadow: none;

			}
			section > .page-header,
			section > .lead {
				color: #5a5a5a;
			}
			section > ul li {
				margin-bottom: 5px;
			}
		</style>

	</head>

	<body>

		<div style="background-color:#f5f5f5" id="head">
			<div class="container">

				<div class="row">
					<span class="span2" style="border-right:1px solid #ccc">
						 <h2><a class="brand " href="http://www.ign.gob.ar/argenmap">Argenmap</a></h2>
					</span><!-- .span2 -->
					<span class="span4 lead">
							<p>Un plugin de
								<a href="http://es.wikipedia.org/wiki/JQuery" target="_blank">jQuery</a>
								para poner un mapa de Argentina en tu web.
							</p>
					</span><!-- .span4 .lead -->
					<p class="span3 pull-right">
						<a target="_blank" href="http://www.ign.gob.ar"><img src="img/icon-ign-48x48.png"></a>
						<a target="_blank" href="http://www.twitter.com/argenmap"><img src="img/twitter-icon.png"></a>
						<a target="_blank" href="http://jquery.com/"><img src="img/jquery-icon.png"></a>
						<a target="_blank" href="http://es.wikipedia.org/wiki/HTML5"><img src="img/html5-icon.png"></a>
					</p><!-- .span3 -->
				</div><!-- row-fluid -->

			</div><!-- .container -->
		</div><!-- #head -->

		<div class="navbar">
			<div class="navbar-inner">
				<a class="brand" href="#">argenmap.jquery v2</a>
				<ul class="nav nav-pills">
					<li><a href="index.html">Guía rápida</a></li>
					<li><a href="caracteristicas.html">Características</a></li>
					<li><a href="api.html">API</a></li>
					<li><a href="ejemplos.html">Ejemplos</a></li>
					<li><a href="#">Casos</a></li>
					<li><a href="#">Acerca de los datos</a></li>
					<li class="active"><a href="#">Creá un mapa para tu sitio</a></li>
				</ul>
			</div><!-- navbar-inner -->
		</div><!-- navbar -->


	<div class="container">

		<!-- Docs nav
		================================================== -->
		<div class="row">
			<div class="span3 bs-docs-sidebar">
				<h4>Configurar tu mapa</h4>
				<div class="accordion" id="accordion2">
					<div class="accordion-group">
						<div class="accordion-heading">
							<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
								Propiedades
							</a>
						</div>
						<div id="collapseOne" class="accordion-body collapse in">
							<div class="accordion-inner">
								<form class="form-inline">
									<div class="clearfix">
										<strong>Ancho:</strong>
										<div class="input-append pull-right">
											<input class="span1" value="800" id="anchoDivVal" type="text">
											<!-- <button class="btn" id="anchoDiv" type="button"><i class="icon-ok-sign"></i></button> -->
										</div>
									</div>
									<div class="clearfix">
										<strong>Alto:</strong>
										<div class="input-append pull-right">
											<input class="span1" value="350" id="altoDivVal" type="text">
											<!-- <button class="btn" id="altoDiv" type="button"><i class="icon-ok-sign"></i></button> -->
										</div>
									</div>
									<!--
									<p>
									<strong>Ancho:</strong> <input type="text" class="input-small pull-right" value="800">
									</p>
									<p>
									<strong>Alto:</strong> <input type="text" class="input-small pull-right" value="350">
									</p>
									-->
									<p class="clearfix">
									<label for="tipoDeMapa"><strong>Tipo de mapa:</strong></label><br />
									<select id="tipoDeMapa">
										<option value="Base IGN">Base IGN</option>
										<option value="Satélite">Satélite</option>
									</select>
									</p>
								</form>
							</div>
						</div>
					</div>

					<div class="accordion-group">
						<div class="accordion-heading">
							<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
								Marcador
							</a>
						</div>
						<div id="collapseTwo" class="accordion-body collapse">
							<div class="accordion-inner">
								<form class="form-search form-horizontal">
									<label>Buscar dirección</label>
									<input type="text" id="geosearch" class="span2 search-query" placeholder="Av. Cabildo 381, Buenos Aires">
									<!-- <div class="input-append">
										<button type="submit" class="btn"><i class="icon-search"></i></button>
									</div> -->
									
									<h6>Información del marcador <small>puedes usar html</small></h6>
									<textarea id="contenidoMarcador" rows="3"><h1>Marcador</h1>Este es el contenido del marcador</textarea>
									<br /><small>Dejar en blanco para que el marcador no sea "clickeable"</small>
									<br /><button id="actualizarInfo" class="pull-right btn btn-primary" type="button">Actualizar marcador <i class="icon-refresh"></i> </button>
								</form>
							</div>
						</div>
					</div>

					<div class="accordion-group">
						<div class="accordion-heading">
							<!-- <a class="accordion-toggle" id="getCode" href="#myModal" data-toggle="modal"> -->
							<a class="accordion-toggle" id="getCode">
								Obtené el código
							</a>
						</div>
					</div>
					
					<!-- modal -->
					<div id="myModal" tabindex="-1" style="width:900px;margin-left:-450px;" class="modal hide fade" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h3>Código</h3>
						</div>
						<div class="modal-body">
							<p>Recuerda incluir las librerías en el <code>HEAD</code> de tu página:</p>
<pre class="prettyprint lang-html">
&lt;script type=&quot;text/javascript&quot; src=&quot;https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;http://www.ign.gob.ar/argenmap2/argenmap.jquery/argenmap.jquery.min.js&quot;&gt;&lt;/script&gt;
</pre>
							<p>Luego agrega este <code>DIV</code> donde quieras ubicar el mapa:</p>
							<div class="well well-small" id="theDivIsTheLaw">
							</div>
							<p>... y por último, inserta este código en un tag <code>SCRIPT</code></p>
							<div class="alert alert-info"><strong>Nota:</strong> El código JavaScript debe
							ejecutarse cuando la página terminó de cargarse</div>
							<textarea id="theCodeIsTheLaw" rows=6 style="width:100%;font-size:13px;"></textarea>
						</div>
						<div class="modal-footer">
							<a data-dismiss="modal" aria-hidden="true" class="btn">Cerrar</a>
						</div>
					</div>
					
				</div>
			</div>
			<div class="span9">
				<section id="examples">
					<div class="resultado shadowed" id="mapaDemo" style="width:800px;height:350px; margin:0 auto;">
					</div>
				</section>
			</div>
		</div>

	</div>



		<!-- Footer
		================================================== -->
		<footer class="footer">
			<p>© Instituto Geográfico Nacional 2013</p>
		</footer>



		<!-- Le javascript
		================================================== -->
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
		<script src="js/bootstrap.js"></script>
		<script src="js/google-code-prettify/prettify.js"></script>
		<script src="http://www.ign.gob.ar/argenmap2/argenmap.jquery/argenmap.jquery.min.js"></script>
		
		<!-- Codigo para la pagina
		================================================== -->
		<script>
			var gc;
			var lastResults = [];
			$(document).ready(function(){
				var $window = $(window);

				// make code pretty
				window.prettyPrint && prettyPrint();
				gc = new google.maps.Geocoder();
				// var callback = function(e){console.log(e);}
				$(document).on("click",'a.georesult',function(e){
						//console.log($(this).data('coords'));
						$('#geosearch').popover('hide');
						$('#mapaDemo').centro($(this).data('lat'),$(this).data('lon')).zoom(12);
						if($('#mapaDemo').data('argenmap').marcadores.length > 0)
						{
							$('#mapaDemo').modificarMarcador("Marcador",{lon:$(this).data('lon'),lat:$(this).data('lat'),contenido:$('#contenidoMarcador').val()});
						}else{
							$('#mapaDemo').agregarMarcador({lon:$(this).data('lon'),lat:$(this).data('lat'),contenido:$('#contenidoMarcador').val()});
						}
						return false;
					}
				);
				$('#getCode').click(function(e){
					var ancho = $.isNumeric($('#anchoDivVal').val()) ? $('#anchoDivVal').val() + 'px' : 'auto';
					var alto = $.isNumeric($('#altoDivVal').val()) ? $('#altoDivVal').val() + 'px' : '300px';
					var divLine = "<div id='mapa' style='width:" + ancho + ";height:" + alto + "'></div>";
					var c = $('#mapaDemo').centro();
					var z = $('#mapaDemo').zoom();
					var base = $('#mapaDemo').capaBase();
					var scriptLine = '$("#mapa").argenmap()\n  .centro('+c[0]+','+c[1]+')\n  .zoom('+z+')';
					if(base == 'Satélite') scriptLine += '\n  .capaBase("'+base+'")';
					if($('#mapaDemo').data('argenmap').marcadores.length > 0) {
						var coords = $('#mapaDemo').data('argenmap').marcadores[0].lonlat.clone();
						coords.transform('EPSG:3857','EPSG:4326');
						scriptLine += '\n  .agregarMarcador({';
						scriptLine += '\n    contenido:"'+$('#contenidoMarcador').val()+'",';
						scriptLine += '\n    lat: '+coords.lat+',';
						scriptLine += '\n    lon: '+coords.lon+'\n})';
					}
					scriptLine += ";";
					$('#myModal #theDivIsTheLaw').text(divLine);
					$('#myModal #theCodeIsTheLaw').text(scriptLine);
					
					$('#myModal').modal();
				});
				$('#actualizarInfo').click(function(e){
					$('#mapaDemo').modificarMarcador("Marcador",{contenido:$('#contenidoMarcador').val()});
				});
				$('#anchoDivVal').blur(function(e){
					var a = $.isNumeric($(this).val()) ? $(this).val() : 'auto';
					$('#mapaDemo').css('width',a);
				});
				$('#altoDivVal').blur(function(e){
					var a = $.isNumeric($(this).val()) ? $(this).val() : '300';
					$('#mapaDemo').css('height',a);
				});
				/*
				$('#anchoDiv').click(function(e){
					var a = $.isNumeric($('#anchoDivVal').val()) ? $('#anchoDivVal').val() : 'auto';
					$('#mapaDemo').css('width',a);
				});
				$('#altoDiv').click(function(e){
					var a = $.isNumeric($('#altoDivVal').val()) ? $('#altoDivVal').val() : '300';
					$('#mapaDemo').css('height',a);
				});
				*/
				$('#tipoDeMapa').change(function(e){
					$('#mapaDemo').capaBase($(this).val());
				});
				$('#geosearch').typeahead({
					source: function( query, callback) {

							var resultsArr = new Array();
							lastResults = new Array();
							// query.replace(".","\.");
							gc.geocode({ 'address': query, region:'ar' }, function (results, status) {

								if (status == google.maps.GeocoderStatus.OK) {
									// console.log(results);
									// for(i=0; i < results.length; i++) {
									//     if(results[i].formatted_address) {
									//         resultsArr[i] = results[i].formatted_address;    
									//     }
									// };
									$('#geosearch').popover('destroy');
									var popoverContent = "";
									$.each(results,function(i,e){
										// console.log(e);
										resultsArr.push(e.formatted_address);
										lastResults.push(e);
										popoverContent += "<a class='georesult' href='#' data-lat='" + e.geometry.location.lat() + "' data-lon='" + e.geometry.location.lng() + "'>" + e.formatted_address + "</a><br />";
									});

									// callback(resultsArr);
									$('#geosearch').popover({
										html: true,
										placement: 'right',
										title: 'Resultados',
										trigger: 'manual',
										content: popoverContent
									}).popover('show');
								};
							});
					},
					items: 5
			});
			$('#mapaDemo').argenmap();
		});
		</script>

		<!-- Analytics
		================================================== -->
		<script type="text/javascript">

			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-689568-24']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();

		</script>

	</body>
</html>
